<div class="umb-panel" ng-controller="UmbracoPersonalisationGroups.RegionPersonalisationGroupCriteriaController">

    <div class="umb-panel-body no-header with-footer compact">
        <p>Please select the country and regions for for the group.</p>

        <umb-control-group alias="match" label="Comparison">
            <select ng-model="renderModel.match">
                <option value="IsLocatedIn">Visitor is located in</option>
                <option value="IsNotLocatedIn">Visitor is not located in</option>
            </select>
        </umb-control-group>

        <umb-control-group alias="countryCode" label="Country">
            <select ng-model="renderModel.countryCode"
                    ng-change="changedCountryCode(renderModel.countryCode)" 
                    ng-options="item.code as item.name for item in availableCountries"></select>
        </umb-control-group>

        <umb-control-group alias="regions" label="Regions">
            <table class="table table-striped">
                <tbody>
                <tr ng-repeat="region in renderModel.regions">
                    <td>
                        <span ng-show="!region.edit">{{getRegionName(region.code)}}</span>
                        <select ng-model="region.code"
                                ng-options="item.code as item.name for item in availableRegions"
                                ng-show="country.edit"></select>
                    </td>
                    <td>
                        <div class="btn-group" ng-show="!country.edit">
                            <button type="button" class="btn btn-default" ng-click="edit($index)"><localize key="edit">Edit</localize></button>
                            <button type="button" class="btn btn-default" ng-click="delete($index)"><localize key="delete">Delete</localize></button>
                        </div>
                        <div class="btn-group" ng-show="country.edit">
                            <button type="button" class="btn btn-default" ng-click="saveEdit($index)"><localize key="buttons_save">Save</localize></button>
                        </div>
                    </td>
                </tr>
                </tbody>
                <tfoot>
                <tr>
                    <td>
                        <select ng-model="newRegion.code"
                                ng-options="item.code as item.name for item in availableRegions"></select>
                    </td>
                    <td>
                        <div class="btn-group">
                            <button type="button" class="btn btn-default" ng-click="add()"><localize key="general_add">Add</localize></button>
                        </div>
                    </td>
                </tr>
                </tfoot>
            </table>
        </umb-control-group>
    </div>

    <div class="umb-panel-footer">
        <div class="umb-el-wrap umb-panel-buttons">
            <div class="btn-toolbar umb-btn-toolbar pull-right">
                <a href ng-click="close()" class="btn btn-link">
                    <localize key="general_cancel">Cancel</localize>
                </a>

                <a href ng-click="saveAndClose()" class="btn btn-primary">
                    <localize key="buttons_save">Save</localize>
                </a>
            </div>
        </div>
    </div>
</div>

